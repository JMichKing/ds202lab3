---
title: "Lab 3 - Team 5"
author: "Lisa McDaniel"
date: "9/23/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, include=FALSE}
library(readxl)
library(tidyverse)
dat <- readxl::read_xls('./GSS.xls', sheet="Data")
names(dat)
str(dat)
dat
```

```{r echo=FALSE, include=FALSE}
dat <- dat %>%
  rename(Sign = "Respondents astrological sign" ) %>%
  rename(Vocab = "Number words correct in vocabulary test") %>%
  rename(Origin = "Country of family origin") %>%
  rename(MarHap = "Married people happier than unmarried") %>%
  rename(Happy = "General happiness") %>%
  rename(PolParty = "Political party affiliation") %>%
  rename(Gender = "Respondents sex") %>%
  rename(School = "Highest year of school completed") %>%
  rename(Occ80 = "Rs occupational prestige score  (1980)") %>%
  rename(Occ70 = "Rs occupational prestige score  (1970)") %>%
  rename(IDnum = "Respondent id number") %>%
  rename(Ballot = "Ballot used for interview") %>%
  rename(Year = "Gss year for this respondent") %>%
  rename(Married = "Marital status")

names(dat)
str(dat)
```
 1. Find the average years of education for the respondents with each political      party affiliation. Arrange your output in a meaningful order. Describe any       pattern you find.
  
  **Observation**` 
  As the political party affiliation moves more to the right the average education level slightly increases.
  
```{r, warning=FALSE}
dat = dat %>% drop_na()
dat <- dat %>%
  mutate(School = as.numeric(School))

dat %>%
  group_by(PolParty) %>%
  summarize(AvgEdu = mean(School, na.rm = TRUE), MedEdu = median(School, na.rm = TRUE)) %>%
  arrange(AvgEdu)
order <- c("Strong democrat", "Not str democrat", "Ind,near dem", "Independent", "Other party", "Ind,near rep", "Not str republican", "Strong republican")

dat2 <- dat %>% select(PolParty, School) %>% drop_na %>%
  mutate(School = as.numeric(School, na.rm = TRUE)) %>%
  group_by(PolParty) %>% 
  summarize(meanYears = mean(School, na.rm = TRUE)) %>%
  filter(PolParty != "Don't know" & PolParty != "No answer") %>%
  mutate(PolParty = factor(PolParty, levels = order)) %>%
  arrange(PolParty)

ggplot(dat2, aes(x = PolParty, weight = meanYears)) +
  geom_bar() +
  theme(axis.text.x = element_text(angle = 90, vjust = .5, hjust = 1)) +
  labs(x = "Political Party", y = "Mean years in school") +
  coord_cartesian(ylim = c(11, 14))

```


  2. Create a single data frame containing records for the better educated            respondents in each political party affiliation. A “better educated”             respondent is someone who has more years of education than the median within      the same party affiliation. Print the structure of the data frame.
 
```{r}
PolPartyEdu <- dat %>%
  select(PolParty, School)

PolPartyEdu <- PolPartyEdu %>%
  group_by(PolParty) %>%
  filter(School >= median(School, na.rm = TRUE))

str(PolPartyEdu)

```  
  

  3. How is the happiness of a respondent related to his/her marriage status?

```{r fig.width=12, fig.height=10}
ggplot(data=dat, aes(Married, fill=Married)) + geom_bar() + theme(legend.position="right") + ggtitle("Married") + theme(plot.title = element_text(hjust = 0.5), axis.title.y = element_blank(), axis.title.x = element_blank(),axis.text.x=element_blank(), axis.ticks.x=element_blank() ) + facet_wrap((~Happy))
```

  4. Does party affiliation affect the relationship you found in the last             question?
  
```{r, warning=FALSE}
order <- c("Never married", "Married", "Widowed", "Separated", "Divorced")
dat2 <- dat %>% select(Happy, Married, PolParty) %>% drop_na %>%
  filter(Married != "No answer" & Happy != "Not applicable" & Happy != "No answer" & Happy != "Don't know" & PolParty != "Don't know" & PolParty != "No answer") %>%
  mutate(Married = factor(Married, levels = order)) %>%
  arrange(Married)
ggplot(dat2, aes(x = Married, fill = Happy)) + geom_bar(position = 'fill') +
  labs(x = "Marital Status", y = "Proportion") + facet_wrap(~PolParty) + 
  theme(axis.text.x = element_text(angle = 90, vjust = .5, hjust = 1))
```

Political party does not seem to have a major effect on the relationship. The same general shape of the graph can be seen in each of the party affiliations.
  
  5. How is marital status related to the education of a respondent? What are        possible reasons accounting for the patterns you see?
  
Interestingly, there really isn't a big swing in the range of martial status, even the median is similar across the groups (except for *No answer*).   

```{r fig.width=12, fig.height=10}
ggplot(data=dat, aes(x=Married, y=School, fill=Married)) + geom_boxplot() + theme(legend.position="right") + ggtitle("Marital Status vs Education") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Marital Status") + ylab("Education Level")
```
  
  6. Explore two more interesting questions, and answer those questions using the      GSS data.
  
*How many vocabulary words did the respondent get correct based on their education level?*  For the most part as the education level increases so does their vocabulary.
```{r}
dat <- dat %>%
  mutate(Vocab = as.numeric(Vocab))
##str(dat)

YearEd <- c(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, "Don't know", "No answer")

ggplot(aes(x=School, y=Vocab, group=School), data=dat) + geom_boxplot() + ggtitle("Education of Vocabulary") + theme(plot.title = element_text(hjust = 0.5), axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) + ylab("Vocabulary") + xlab("Years of Education") + scale_x_discrete(limits = YearEd) + scale_x_continuous(limits = c(-1,21))
```


