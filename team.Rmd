---
title: "Lab 3 - Team 5"
author: "Lisa McDaniel"
date: "9/23/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
**Lisa McDaniel - Exploratory Analysis Summery**
We selected and downloaded 14 variables of interest from GSS Data Explorer site.  I renamed almost all the columns.  There are 64,814 observations in the dataset with the following columns: 1) Gss year for this respondent, 2) Respondents astrological sign, 3) Number words correct in vocabulary test, 4) Country of family origin, 5) Married people happier than unmarried, 6) General happiness, 7) Political party affiliation, 8) Respondents sex, 9) Highest year of school completed, 10) Marital status, 11) Rs occupational prestige score  (1980), 12) Rs occupational prestige score  (1970), 13) Respondent id number and 14) Ballot used for interview.  

I did a bit of cleaning of the datset including dropping *NA* values, changing the *Number words correct in vocabulary test*, *Gss year for this respondent* and *Highest year of school completed* to numeric and renaming the columns as follows: 1) Year, 2) Sign, 3) Vocab, 4) Origin, 5) MarHap,6) Happy, 7) PolParty, 8) Gender, 9) School, 10) Married, 11) Occ80, 12)Occ70, 13) IDnum and 14) Ballot.   


**John King - Exploratory Analysis Summary**




```{r}
library(readxl)
library(tidyverse)
dat <- readxl::read_xls('../ds202lab3/GSS.xls', sheet="Data")
names(dat)
str(dat)
dat
```

```{r echo=FALSE}
dat <- dat %>%
  rename(Sign = "Respondents astrological sign" ) %>%
  rename(Vocab = "Number words correct in vocabulary test") %>%
  rename(Origin = "Country of family origin") %>%
  rename(MarHap = "Married people happier than unmarried") %>%
  rename(Happy = "General happiness") %>%
  rename(PolParty = "Political party affiliation") %>%
  rename(Gender = "Respondents sex") %>%
  rename(School = "Highest year of school completed") %>%
  rename(Occ80 = "Rs occupational prestige score  (1980)") %>%
  rename(Occ70 = "Rs occupational prestige score  (1970)") %>%
  rename(IDnum = "Respondent id number") %>%
  rename(Ballot = "Ballot used for interview") %>%
  rename(Year = "Gss year for this respondent") %>%
  rename(Married = "Marital status")

names(dat)
str(dat)
```
 1. Find the average years of education for the respondents with each political      party affiliation. Arrange your output in a meaningful order. Describe any       pattern you find.
  
  **Observation**` 
```{r}
dat = dat %>% drop_na()
dat <- dat %>%
  mutate(School = as.numeric(School))

dat %>%
  group_by(PolParty) %>%
  summarize(AvgEdu = mean(School, na.rm = TRUE), MedEdu = median(School, na.rm = TRUE)) %>%
  arrange(AvgEdu)

```


  2. Create a single data frame containing records for the better educated            respondents in each political party affiliation. A “better educated”             respondent is someone who has more years of education than the median within      the same party affiliation. Print the structure of the data frame.
 
```{r}
PolPartyEdu <- dat %>%
  select(PolParty, School)

PolPartyEdu <- PolPartyEdu %>%
  group_by(PolParty) %>%
  filter(School >= median(School, na.rm = TRUE))

str(PolPartyEdu)

```  
  

  3. How is the happiness of a respondent related to his/her marriage status?
  
  
  
  4. Does party affiliation affect the relationship you found in the last             question?
  
  
  
  5. How is marrital status related to the education of a respondent? What are        possible reasons accounting for the patterns you see?
  
  
  
  6. Explore two more interesting questions, and answer those questions using the      GSS data.
  
*How many vocabulary words did the respondent get correct based on their education level?*
```{r}
dat <- dat %>%
  mutate(Vocab = as.numeric(Vocab))
##str(dat)

YearEd <- c(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, "Don't know", "No answer")

ggplot(aes(x=School, y=Vocab, group=School), data=dat) + geom_boxplot() + ggtitle("Education of Vocabulary") + theme(plot.title = element_text(hjust = 0.5), axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) + ylab("Vocabulary") + xlab("Years of Education") + scale_x_discrete(limits = YearEd) + scale_x_continuous(limits = c(-1,21))
```
